{"address":"534wWgkhRQFvNMpzC5bGsYWXQwJjEkwU3M9iokRNTKrp","metadata":{"name":"merchant_solana","version":"0.1.0","spec":"0.1.0"},"instructions":[{"name":"initialize","docs":["Initialize the program with admin, token mint, and configuration"],"discriminator":[175,175,109,31,13,152,155,237],"accounts":[{"name":"program_state","writable":true},{"name":"admin_list","writable":true},{"name":"reward_token_mint"},{"name":"payer","writable":true,"signer":true},{"name":"system_program"}],"args":[{"name":"initial_admin","type":"pubkey"},{"name":"cooldown_period","type":"i64"}]},{"name":"add_admin","docs":["Add a new admin to the program"],"discriminator":[177,236,33,205,124,152,55,186],"accounts":[{"name":"program_state"},{"name":"admin_list","writable":true},{"name":"authority","writable":true,"signer":true}],"args":[{"name":"new_admin","type":"pubkey"}]},{"name":"remove_admin","docs":["Remove an admin from the program"],"discriminator":[74,202,71,106,252,31,72,183],"accounts":[{"name":"program_state"},{"name":"admin_list","writable":true},{"name":"authority","writable":true,"signer":true}],"args":[{"name":"admin_to_remove","type":"pubkey"}]},{"name":"add_store","docs":["Add a new store to the program with optional tiers"],"discriminator":[220,17,176,152,172,114,235,83],"accounts":[{"name":"store","writable":true},{"name":"program_state","writable":true},{"name":"admin_list"},{"name":"authority","writable":true,"signer":true},{"name":"system_program"}],"args":[{"name":"name","type":"string"},{"name":"settings","type":{"defined":{"name":"StoreSettingsInput"}}}]},{"name":"update_store","docs":["Update an existing store's information, including tiers"],"discriminator":[169,49,137,251,233,234,172,103],"accounts":[{"name":"store","writable":true},{"name":"program_state"},{"name":"admin_list"},{"name":"authority","writable":true,"signer":true},{"name":"system_program"}],"args":[{"name":"name","type":{"option":"string"}},{"name":"uri","type":{"option":"string"}},{"name":"address","type":{"option":"string"}},{"name":"max_memberships","type":{"option":"u64"}},{"name":"active","type":{"option":"bool"}},{"name":"tiers","type":{"option":{"vec":{"defined":{"name":"TierInput"}}}}},{"name":"default_reward_rate_basis_points","type":{"option":{"option":"u16"}}},{"name":"default_fixed_reward_amount","type":{"option":{"option":"u64"}}},{"name":"default_cooldown_period","type":{"option":{"option":"i64"}}}]},{"name":"check_in","docs":["Combined check-in function: handles membership creation/update and reward claiming based on tiers/variable input."],"discriminator":[209,253,4,217,250,241,207,50],"accounts":[{"name":"membership","writable":true},{"name":"store","writable":true},{"name":"program_state","writable":true},{"name":"admin_list"},{"name":"vault","writable":true},{"name":"user_token_account","writable":true},{"name":"user","docs":["The user checking in (doesn't need to sign)"]},{"name":"authority","writable":true,"signer":true},{"name":"system_program"},{"name":"token_program"}],"args":[{"name":"reward_basis","type":{"option":"u64"}}]},{"name":"update_membership_tier","docs":["Update a user's membership tier for a specific store"],"discriminator":[172,11,253,102,202,174,204,160],"accounts":[{"name":"membership","writable":true},{"name":"store"},{"name":"program_state"},{"name":"admin_list"},{"name":"authority","writable":true,"signer":true}],"args":[{"name":"new_tier_index","type":"u8"}]},{"name":"time_until_next_claim","docs":["Get time until next claim, considering tiers"],"discriminator":[50,25,13,214,125,178,202,17],"accounts":[{"name":"membership"},{"name":"store"}],"args":[],"returns":"i64"},{"name":"pause_program","docs":["Emergency pause the program"],"discriminator":[91,86,253,175,66,236,172,124],"accounts":[{"name":"program_state","writable":true},{"name":"admin_list"},{"name":"authority","writable":true,"signer":true}],"args":[]},{"name":"unpause_program","docs":["Unpause the program"],"discriminator":[43,162,233,92,254,62,69,58],"accounts":[{"name":"program_state","writable":true},{"name":"admin_list"},{"name":"authority","writable":true,"signer":true}],"args":[]},{"name":"deposit_tokens","docs":["Deposit tokens into the vault"],"discriminator":[176,83,229,18,191,143,176,150],"accounts":[{"name":"program_state"},{"name":"from","writable":true},{"name":"vault","writable":true},{"name":"depositor","writable":true,"signer":true},{"name":"token_program"}],"args":[{"name":"amount","type":"u64"}]},{"name":"withdraw_tokens","docs":["Withdraw tokens from the vault"],"discriminator":[2,4,225,61,19,182,106,170],"accounts":[{"name":"program_state"},{"name":"admin_list"},{"name":"vault","writable":true},{"name":"recipient","writable":true},{"name":"authority","writable":true,"signer":true},{"name":"token_program"}],"args":[{"name":"amount","type":"u64"}]},{"name":"withdraw_sol","docs":["Withdraw SOL from the program state account"],"discriminator":[145,131,74,136,65,137,42,38],"accounts":[{"name":"program_state","writable":true},{"name":"admin_list"},{"name":"authority","writable":true,"signer":true}],"args":[{"name":"amount","type":"u64"}]},{"name":"get_vault_balance","docs":["Utility function to get vault token balance (purely for convenience)"],"discriminator":[42,94,16,2,169,162,12,134],"accounts":[{"name":"program_state"},{"name":"vault"}],"args":[],"returns":"u64"}],"accounts":[{"name":"ProgramState","discriminator":[77,209,137,229,149,67,167,230]},{"name":"AdminList","discriminator":[253,56,210,167,203,37,230,165]},{"name":"Membership","discriminator":[231,141,180,98,109,168,175,166]},{"name":"Store","discriminator":[130,48,247,244,182,191,30,26]}],"errors":[{"code":6000,"name":"Unauthorized","msg":"Unauthorized: You don't have permission to perform this action."},{"code":6001,"name":"UriTooLong","msg":"URI string is too long."},{"code":6002,"name":"InvalidName","msg":"Store name is invalid."},{"code":6003,"name":"Overflow","msg":"Calculation overflow."},{"code":6004,"name":"InsufficientBalance","msg":"Insufficient balance for withdrawal."},{"code":6005,"name":"CooldownActive","msg":"Cooldown period not met."},{"code":6006,"name":"ProgramPaused","msg":"Program is currently paused."},{"code":6007,"name":"ProgramAlreadyPaused","msg":"Program is already paused."},{"code":6008,"name":"ProgramNotPaused","msg":"Program is not currently paused."},{"code":6009,"name":"InvalidCooldownPeriod","msg":"Invalid cooldown period. Must be non-negative."},{"code":6010,"name":"StoreInactive","msg":"Store is not active."},{"code":6011,"name":"InvalidAmount","msg":"Invalid amount."},{"code":6012,"name":"InsufficientVaultBalance","msg":"Insufficient vault balance for operation."},{"code":6013,"name":"AdminAlreadyExists","msg":"Admin already exists."},{"code":6014,"name":"AdminNotFound","msg":"Admin not found."},{"code":6015,"name":"CannotRemoveSelf","msg":"Cannot remove yourself as admin."},{"code":6016,"name":"AlreadyHasMembership","msg":"User already has a membership for this store."},{"code":6017,"name":"NoMembership","msg":"User doesn't have a membership for this store."},{"code":6018,"name":"MaxMembershipsReached","msg":"Maximum memberships reached for this store."},{"code":6019,"name":"MaxMembershipsTooLow","msg":"New max memberships must be >= current membership count."},{"code":6020,"name":"InvalidTierName","msg":"Tier name is invalid (length must be > 0 and <= 32)."},{"code":6021,"name":"TierMustHaveReward","msg":"Tier must have either a reward rate or a fixed reward amount defined."},{"code":6022,"name":"TiersCannotBeEmpty","msg":"If using tiers, the tiers vector cannot be empty."},{"code":6023,"name":"TooManyTiers","msg":"Maximum number of tiers per store exceeded."},{"code":6024,"name":"InvalidTierIndex","msg":"Invalid tier index provided."},{"code":6025,"name":"StoreHasNoTiers","msg":"Store does not have tiers defined."},{"code":6026,"name":"StoreMustHaveDefaultReward","msg":"Store must have a default reward (rate or fixed amount) if no tiers are defined."},{"code":6027,"name":"RewardBasisRequiredForRate","msg":"Reward basis (e.g., amount spent) must be provided when using rate-based rewards."},{"code":6028,"name":"AddressTooLong","msg":"Address exceeds maximum allowed length."}],"types":[{"name":"TierInfo","docs":["Tier definition"],"type":{"kind":"struct","fields":[{"name":"name","type":"string"},{"name":"reward_rate_basis_points","type":{"option":"u16"}},{"name":"fixed_reward_amount","type":{"option":"u64"}},{"name":"cooldown_period","type":{"option":"i64"}}]}},{"name":"StoreSettingsInput","docs":["Input struct for Store settings during add_store"],"type":{"kind":"struct","fields":[{"name":"uri","type":"string"},{"name":"address","type":"string"},{"name":"max_memberships","type":"u64"},{"name":"tiers","type":{"option":{"vec":{"defined":{"name":"TierInput"}}}}},{"name":"default_reward_rate_basis_points","type":{"option":"u16"}},{"name":"default_fixed_reward_amount","type":{"option":"u64"}},{"name":"default_cooldown_period","type":{"option":"i64"}}]}},{"name":"TierInput","docs":["Input struct for TierInfo during instruction calls"],"type":{"kind":"struct","fields":[{"name":"name","type":"string"},{"name":"reward_rate_basis_points","type":{"option":"u16"}},{"name":"fixed_reward_amount","type":{"option":"u64"}},{"name":"cooldown_period","type":{"option":"i64"}}]}},{"name":"ProgramState","docs":["Account to hold global program state"],"type":{"kind":"struct","fields":[{"name":"paused","docs":["Whether the program is currently paused"],"type":"bool"},{"name":"next_store_id","docs":["The next available store ID"],"type":"u64"},{"name":"bump","docs":["PDA bump seed"],"type":"u8"},{"name":"reward_token_mint","docs":["The public key of the reward token mint"],"type":"pubkey"},{"name":"default_cooldown_period","docs":["Default cooldown period for stores without specific cooldown settings"],"type":"i64"},{"name":"created_at","docs":["Timestamp when the program was created"],"type":"i64"}]}},{"name":"AdminList","docs":["Account for storing admin public keys and count"],"type":{"kind":"struct","fields":[{"name":"admins","docs":["Vector of admin public keys"],"type":{"vec":"pubkey"}},{"name":"admin_count","docs":["Total number of admins"],"type":"u32"},{"name":"bump","docs":["PDA bump seed"],"type":"u8"}]}},{"name":"Membership","docs":["Account structure for tracking user membership at a store"],"type":{"kind":"struct","fields":[{"name":"user","docs":["Public key of the user"],"type":"pubkey"},{"name":"store_id","docs":["ID of the store this membership is for"],"type":"u64"},{"name":"has_membership","docs":["Whether the user has an active membership"],"type":"bool"},{"name":"mint_time","docs":["Timestamp when the membership was created"],"type":"i64"},{"name":"last_claim_time","docs":["Timestamp of the last reward claim"],"type":"i64"},{"name":"check_in_count","docs":["Total number of check-ins"],"type":"u32"},{"name":"total_rewards_earned","docs":["Total rewards earned by this membership"],"type":"u64"},{"name":"bump","docs":["PDA bump seed"],"type":"u8"},{"name":"tier_index","docs":["Index into the store's tiers vector"],"type":"u8"}]}},{"name":"Store","docs":["Account structure for storing information about each store"],"type":{"kind":"struct","fields":[{"name":"store_id","docs":["Unique identifier for the store"],"type":"u64"},{"name":"name","docs":["Name of the store (max 50 chars)"],"type":"string"},{"name":"authority","docs":["Public key of the store's authority"],"type":"pubkey"},{"name":"max_memberships","docs":["Maximum number of memberships allowed"],"type":"u64"},{"name":"membership_count","docs":["Current number of memberships"],"type":"u64"},{"name":"uri","docs":["URI for store metadata (max 200 chars)"],"type":"string"},{"name":"address","docs":["Physical address of the store (max 200 chars)"],"type":"string"},{"name":"created_at","docs":["Timestamp when the store was created"],"type":"i64"},{"name":"active","docs":["Whether the store is currently active"],"type":"bool"},{"name":"total_check_ins","docs":["Total number of check-ins at this store"],"type":"u64"},{"name":"bump","docs":["PDA bump seed"],"type":"u8"},{"name":"tiers","docs":["List of tiers for this store"],"type":{"vec":{"defined":{"name":"TierInfo"}}}},{"name":"default_reward_rate_basis_points","docs":["Default reward rate in basis points (if no tiers)"],"type":{"option":"u16"}},{"name":"default_fixed_reward_amount","docs":["Default fixed reward amount (if no tiers)"],"type":{"option":"u64"}},{"name":"default_cooldown_period","docs":["Default cooldown period (if no tiers)"],"type":"i64"},{"name":"reward_amount","docs":["Reward amount for the store (for backward compatibility)"],"type":"u64"},{"name":"cooldown_period","docs":["Cooldown period for the store (for backward compatibility)"],"type":"i64"}]}}]}