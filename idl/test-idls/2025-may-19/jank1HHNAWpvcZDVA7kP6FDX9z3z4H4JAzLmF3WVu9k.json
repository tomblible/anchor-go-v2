{"version":"0.1.0","name":"janken","instructions":[{"name":"createGame","accounts":[{"name":"gameAccount","isMut":true,"isSigner":false},{"name":"creator","isMut":true,"isSigner":true},{"name":"systemProgram","isMut":false,"isSigner":false}],"args":[]},{"name":"createClient","accounts":[{"name":"clientAccount","isMut":true,"isSigner":false},{"name":"client","isMut":true,"isSigner":true},{"name":"systemProgram","isMut":false,"isSigner":false}],"args":[]},{"name":"createLeader","accounts":[{"name":"leaderAccount","isMut":true,"isSigner":false},{"name":"leader","isMut":true,"isSigner":true},{"name":"systemProgram","isMut":false,"isSigner":false}],"args":[]},{"name":"generateLeaderChallenge","accounts":[{"name":"gameAccount","isMut":true,"isSigner":false},{"name":"leaderAccount","isMut":true,"isSigner":false},{"name":"leaderCommitAccount","isMut":true,"isSigner":false},{"name":"leader","isMut":true,"isSigner":true},{"name":"systemProgram","isMut":false,"isSigner":false},{"name":"recentSlothashes","isMut":false,"isSigner":false}],"args":[]},{"name":"regenerateLeaderChallenge","accounts":[{"name":"gameAccount","isMut":true,"isSigner":false},{"name":"roundAccount","isMut":true,"isSigner":false},{"name":"leaderAccount","isMut":true,"isSigner":false},{"name":"leaderCommitAccount","isMut":true,"isSigner":false},{"name":"leader","isMut":true,"isSigner":true},{"name":"systemProgram","isMut":false,"isSigner":false},{"name":"recentSlothashes","isMut":false,"isSigner":false}],"args":[]},{"name":"commitLeaderToken","accounts":[{"name":"gameAccount","isMut":true,"isSigner":false},{"name":"roundAccount","isMut":true,"isSigner":false},{"name":"leaderAccount","isMut":true,"isSigner":false},{"name":"leaderCommitAccount","isMut":true,"isSigner":false},{"name":"leader","isMut":true,"isSigner":true},{"name":"challenge","isMut":true,"isSigner":true},{"name":"systemProgram","isMut":false,"isSigner":false}],"args":[{"name":"sealedToken","type":{"defined":"SealedToken"}}]},{"name":"recommitLeaderToken","accounts":[{"name":"gameAccount","isMut":true,"isSigner":false},{"name":"roundAccount","isMut":true,"isSigner":false},{"name":"leaderAccount","isMut":true,"isSigner":false},{"name":"leaderCommitAccount","isMut":true,"isSigner":false},{"name":"leader","isMut":true,"isSigner":true},{"name":"challenge","isMut":true,"isSigner":true},{"name":"systemProgram","isMut":false,"isSigner":false}],"args":[{"name":"sealedToken","type":{"defined":"SealedToken"}}]},{"name":"commitPlayerToken","accounts":[{"name":"gameAccount","isMut":true,"isSigner":false},{"name":"clientAccount","isMut":true,"isSigner":false},{"name":"roundAccount","isMut":true,"isSigner":false},{"name":"playerAccount","isMut":true,"isSigner":false},{"name":"playerCommitAccount","isMut":true,"isSigner":false},{"name":"player","isMut":true,"isSigner":true},{"name":"client","isMut":true,"isSigner":true},{"name":"systemProgram","isMut":false,"isSigner":false}],"args":[{"name":"sealedToken","type":{"defined":"SealedToken"}}]},{"name":"revealLeaderToken","accounts":[{"name":"gameAccount","isMut":true,"isSigner":false},{"name":"roundAccount","isMut":true,"isSigner":false},{"name":"leaderAccount","isMut":true,"isSigner":false},{"name":"leaderCommitAccount","isMut":true,"isSigner":false},{"name":"leader","isMut":true,"isSigner":true},{"name":"systemProgram","isMut":false,"isSigner":false}],"args":[{"name":"revealedToken","type":{"defined":"RevealedToken"}}]},{"name":"revealPlayerToken","accounts":[{"name":"gameAccount","isMut":true,"isSigner":false},{"name":"roundAccount","isMut":true,"isSigner":false},{"name":"playerAccount","isMut":true,"isSigner":false},{"name":"playerCommitAccount","isMut":true,"isSigner":false},{"name":"leaderAccount1","isMut":true,"isSigner":false},{"name":"leaderAccount2","isMut":true,"isSigner":false},{"name":"player","isMut":true,"isSigner":true},{"name":"systemProgram","isMut":false,"isSigner":false}],"args":[{"name":"revealedToken","type":{"defined":"RevealedToken"}}]},{"name":"redeemPlayerPoints","accounts":[{"name":"gameAccount","isMut":true,"isSigner":false},{"name":"roundAccount","isMut":true,"isSigner":false},{"name":"playerAccount","isMut":true,"isSigner":false},{"name":"player","isMut":true,"isSigner":true},{"name":"systemProgram","isMut":false,"isSigner":false}],"args":[{"name":"points","type":"u64"}]},{"name":"closePlayerCommit","accounts":[{"name":"roundAccount","isMut":true,"isSigner":false},{"name":"playerCommitAccount","isMut":true,"isSigner":false},{"name":"player","isMut":true,"isSigner":true}],"args":[]},{"name":"redeemLeaderLamports","accounts":[{"name":"gameAccount","isMut":true,"isSigner":false},{"name":"leaderAccount","isMut":true,"isSigner":false},{"name":"leader","isMut":true,"isSigner":true},{"name":"systemProgram","isMut":false,"isSigner":false}],"args":[]},{"name":"redeemClientLamports","accounts":[{"name":"gameAccount","isMut":true,"isSigner":false},{"name":"clientAccount","isMut":true,"isSigner":false},{"name":"client","isMut":true,"isSigner":true},{"name":"systemProgram","isMut":false,"isSigner":false}],"args":[]},{"name":"closeLeaderCommit","accounts":[{"name":"roundAccount","isMut":true,"isSigner":false},{"name":"leaderAccount","isMut":true,"isSigner":false},{"name":"leaderCommitAccount","isMut":true,"isSigner":false},{"name":"leader","isMut":true,"isSigner":true}],"args":[]}],"accounts":[{"name":"GameAccount","type":{"kind":"struct","fields":[{"name":"bump","type":"u8"},{"name":"timestamp","type":"u64"},{"name":"updateTs","type":"u64"},{"name":"status","type":{"defined":"GameStatus"}},{"name":"difficulty","type":"u8"},{"name":"round","type":"u64"},{"name":"roundStartTs","type":"u64"}]}},{"name":"RoundAccount","type":{"kind":"struct","fields":[{"name":"id","type":"u64"},{"name":"bump","type":"u8"},{"name":"timestamp","type":"u64"},{"name":"status","type":{"defined":"RoundStatus"}},{"name":"lamports","type":"u64"},{"name":"lamportsHigh","type":"u64"},{"name":"points","type":"u64"},{"name":"leaders","type":{"array":["publicKey",3]}},{"name":"feeLeader1","type":"publicKey"},{"name":"feeLeader2","type":"publicKey"},{"name":"sealedTokens","type":{"array":[{"defined":"SealedToken"},3]}},{"name":"revealedTokens","type":{"array":[{"defined":"Token"},3]}},{"name":"leaderResult","type":{"defined":"Token"}}]}},{"name":"PlayerAccount","type":{"kind":"struct","fields":[{"name":"bump","type":"u8"},{"name":"timestamp","type":"u64"},{"name":"status","type":{"defined":"PlayerStatus"}},{"name":"pubkey","type":"publicKey"},{"name":"points","type":"u64"}]}},{"name":"LeaderCommitAccount","type":{"kind":"struct","fields":[{"name":"bump","type":"u8"},{"name":"timestamp","type":"u64"},{"name":"status","type":{"defined":"LeaderCommitStatus"}},{"name":"round","type":"u64"},{"name":"pubkey","type":"publicKey"},{"name":"lamports","type":"u64"},{"name":"challenge","type":{"array":["u8",8]}},{"name":"sealedToken","type":{"defined":"SealedToken"}},{"name":"revealedToken","type":{"defined":"Token"}}]}},{"name":"PlayerCommitAccount","type":{"kind":"struct","fields":[{"name":"bump","type":"u8"},{"name":"timestamp","type":"u64"},{"name":"status","type":{"defined":"PlayerCommitStatus"}},{"name":"round","type":"u64"},{"name":"pubkey","type":"publicKey"},{"name":"lamports","type":"u64"},{"name":"sealedToken","type":{"defined":"SealedToken"}},{"name":"revealedToken","type":{"defined":"Token"}},{"name":"result","type":{"defined":"RevealPlayerTokenResult"}}]}},{"name":"EngageResultAccount","type":{"kind":"struct","fields":[{"name":"bump","type":"u8"},{"name":"timestamp","type":"u64"},{"name":"pubkey","type":"publicKey"},{"name":"token","type":{"defined":"Token"}},{"name":"result","type":{"defined":"RevealPlayerTokenResult"}}]}},{"name":"ClientAccount","type":{"kind":"struct","fields":[{"name":"bump","type":"u8"},{"name":"timestamp","type":"u64"},{"name":"status","type":{"defined":"ClientStatus"}},{"name":"pubkey","type":"publicKey"}]}},{"name":"LeaderAccount","type":{"kind":"struct","fields":[{"name":"bump","type":"u8"},{"name":"timestamp","type":"u64"},{"name":"status","type":{"defined":"LeaderStatus"}},{"name":"pubkey","type":"publicKey"}]}}],"types":[{"name":"SealedToken","type":{"kind":"struct","fields":[{"name":"hashedToken","type":{"array":["u8",32]}}]}},{"name":"RevealedToken","type":{"kind":"struct","fields":[{"name":"token","type":{"defined":"Token"}},{"name":"nonce","type":"string"}]}},{"name":"GameStatus","type":{"kind":"enum","variants":[{"name":"None"},{"name":"Created"}]}},{"name":"RoundStatus","type":{"kind":"enum","variants":[{"name":"None"},{"name":"Started"},{"name":"Continued"},{"name":"Ended"}]}},{"name":"PlayerStatus","type":{"kind":"enum","variants":[{"name":"None"},{"name":"Created"},{"name":"Committed"}]}},{"name":"LeaderCommitStatus","type":{"kind":"enum","variants":[{"name":"None"},{"name":"Created"},{"name":"Revealed"}]}},{"name":"PlayerCommitStatus","type":{"kind":"enum","variants":[{"name":"None"},{"name":"Created"},{"name":"Revealed"}]}},{"name":"ClientStatus","type":{"kind":"enum","variants":[{"name":"None"},{"name":"Created"}]}},{"name":"LeaderStatus","type":{"kind":"enum","variants":[{"name":"None"},{"name":"Created"}]}},{"name":"RevealPlayerTokenResult","type":{"kind":"enum","variants":[{"name":"None"},{"name":"Win"},{"name":"Lose"},{"name":"Pass"}]}},{"name":"Token","type":{"kind":"enum","variants":[{"name":"None"},{"name":"Rock"},{"name":"Paper"},{"name":"Scissors"}]}}],"errors":[{"code":6000,"name":"CommitLeaderTokenInvalidRoundStatus","msg":"round status must be none"},{"code":6001,"name":"CommitLeaderTokenInvalidCommitWindow","msg":"commits must happen 60s or more after round start timestamp"},{"code":6002,"name":"CommitLeaderTokenInvalidChallenge","msg":"challenge address must start with challenge bytes encoded to base58"},{"code":6003,"name":"CommitLeaderTokenLeaderSlotsUnavailable","msg":"no more leader slots are available for this round"},{"code":6004,"name":"CommitPlayerTokenInvalidRoundStatus","msg":"round status must be started"},{"code":6005,"name":"CommitPlayerTokenInvalidCommitWindow","msg":"commits must happen after round start timestamp"},{"code":6006,"name":"RecommitLeaderTokenInvalidRoundStatus","msg":"round status must be continued"},{"code":6007,"name":"RecommitLeaderTokenInvalidCommitWindow","msg":"commits must happen 120s or more after round start timestamp"},{"code":6008,"name":"RecommitLeaderTokenInvalidChallenge","msg":"challenge address must start with challenge bytes encoded to base58"},{"code":6009,"name":"RecommitLeaderTokenLeaderSlotsUnavailable","msg":"no more leader slots are available for this round"},{"code":6010,"name":"RedeemPlayerPointsInvalidRoundStatus","msg":"round status must be ended"},{"code":6011,"name":"RedeemPlayerPointsInsufficientPoints","msg":"the player account and round account must have enough points to honor the redemption"},{"code":6012,"name":"RedeemPlayerPointsInsufficientLamports","msg":"the round account must have enough lamports to honor the redemption"},{"code":6013,"name":"RevealLeaderTokenInvalidRoundStatus","msg":"round status must be started"},{"code":6014,"name":"RevealLeaderTokenInvalidRevealWindow","msg":"reveals must happen 120s or more after round start timestamp"},{"code":6015,"name":"RevealLeaderTokenPendingCommits","msg":"reveals can only happen once all sealed token slots have been filled"},{"code":6016,"name":"RevealLeaderTokenUnknownLeader","msg":"the current leader must match a leader registered with this round"},{"code":6017,"name":"RevealLeaderTokenInconsistentSealedToken","msg":"the round's sealed token for this leader must match the leader commit account's sealed token for this leader"},{"code":6018,"name":"RevealLeaderTokenInvalidReveal","msg":"the revealed token when hashed using the provided nonce must match the sealed token"},{"code":6019,"name":"RevealPlayerTokenInvalidRoundStatus","msg":"round status must be ended"},{"code":6020,"name":"RevealPlayerTokenDuplicateReveal","msg":"player reveals can only happen once per round"},{"code":6021,"name":"RevealPlayerTokenInvalidReveal","msg":"the revealed token when hashed using the provided nonce must match the sealed token"},{"code":6022,"name":"CloseLeaderCommitInvalidLeaderCommitStatus","msg":"commit account status must be revealed"},{"code":6023,"name":"CloseLeaderCommitInvalidRoundStatus","msg":"round account status must be ended"},{"code":6024,"name":"ClosePlayerCommitInvalidPlayerCommitStatus","msg":"commit account status must be revealed"},{"code":6025,"name":"ClosePlayerCommitInvalidRoundStatus","msg":"round account status must be ended"}]}