{"version":"0.1.3","name":"clp_vault","instructions":[{"name":"initialize","accounts":[{"name":"payer","isMut":true,"isSigner":true,"docs":["The payer funding the transaction"]},{"name":"tokenMintA","isMut":false,"isSigner":false,"docs":["SPL token Mint A of the trading pair"]},{"name":"tokenMintB","isMut":false,"isSigner":false,"docs":["SPL Token mint B of the trading pair"]},{"name":"clp","isMut":false,"isSigner":false},{"name":"clpVault","isMut":true,"isSigner":false},{"name":"tokenVaultA","isMut":true,"isSigner":false,"docs":["An SPL token Account for staging A tokens"]},{"name":"tokenVaultB","isMut":true,"isSigner":false,"docs":["An SPL token Account for staging B tokens"]},{"name":"lpMint","isMut":true,"isSigner":false,"docs":["An SPL token Mint for the vault LP tokens"]},{"name":"tokenProgram","isMut":false,"isSigner":false},{"name":"rent","isMut":false,"isSigner":false},{"name":"systemProgram","isMut":false,"isSigner":false}],"args":[{"name":"nonce","type":"u16"},{"name":"adminKey","type":"publicKey"},{"name":"marketMakingKey","type":"publicKey"},{"name":"feeOwner","type":"publicKey"},{"name":"performanceFee","type":"u32"},{"name":"withdrawalFee","type":"u32"},{"name":"marketMakingFee","type":"u32"},{"name":"strategyType","type":{"defined":"StrategyType"}},{"name":"initialTokenRatio","type":{"defined":"TokenRatio"}}]},{"name":"updateConfig","accounts":[{"name":"adminKey","isMut":true,"isSigner":true},{"name":"clpVault","isMut":true,"isSigner":false}],"args":[{"name":"marketMakingKey","type":"publicKey"},{"name":"feeOwner","type":"publicKey"},{"name":"performanceFee","type":"u32"},{"name":"withdrawalFee","type":"u32"},{"name":"marketMakingFee","type":"u32"},{"name":"strategyType","type":{"defined":"StrategyType"}},{"name":"stakePool","type":"publicKey"},{"name":"featuresEnabled","type":"u8"}]},{"name":"initializePositionBundle","accounts":[{"name":"payer","isMut":true,"isSigner":true},{"name":"clpVault","isMut":true,"isSigner":false},{"name":"clpProgram","isMut":false,"isSigner":false},{"name":"positionBundle","isMut":true,"isSigner":false},{"name":"positionBundleMint","isMut":true,"isSigner":true},{"name":"positionBundleTokenAccount","isMut":true,"isSigner":false},{"name":"tokenProgram","isMut":false,"isSigner":false},{"name":"rent","isMut":false,"isSigner":false},{"name":"systemProgram","isMut":false,"isSigner":false},{"name":"associatedTokenProgram","isMut":false,"isSigner":false}],"args":[]},{"name":"deposit","accounts":[{"name":"payer","isMut":false,"isSigner":true},{"name":"userTokenA","isMut":true,"isSigner":false},{"name":"userTokenB","isMut":true,"isSigner":false},{"name":"userLpTokenAcct","isMut":true,"isSigner":false},{"name":"clpVault","isMut":false,"isSigner":false},{"name":"lpMint","isMut":true,"isSigner":false,"docs":["The SPL token Mint address for ClpVault liquidity providers"]},{"name":"tokenVaultA","isMut":true,"isSigner":false},{"name":"tokenVaultB","isMut":true,"isSigner":false},{"name":"positionBundleTokenAccount","isMut":false,"isSigner":false},{"name":"clpProgram","isMut":false,"isSigner":false},{"name":"clp","isMut":true,"isSigner":false,"docs":["the CLP program."]},{"name":"clpTokenVaultA","isMut":true,"isSigner":false},{"name":"clpTokenVaultB","isMut":true,"isSigner":false},{"name":"tokenProgram","isMut":false,"isSigner":false}],"args":[{"name":"lpMintAmount","type":"u64"},{"name":"tokenMaxA","type":"u64"},{"name":"tokenMaxB","type":"u64"}]},{"name":"withdraw","accounts":[{"name":"payer","isMut":false,"isSigner":true,"docs":["The address paying for the transaction."]},{"name":"userTokenA","isMut":true,"isSigner":false},{"name":"userTokenB","isMut":true,"isSigner":false},{"name":"userLpTokenAcct","isMut":true,"isSigner":false},{"name":"clpVault","isMut":false,"isSigner":false},{"name":"lpMint","isMut":true,"isSigner":false,"docs":["The SPL token Mint address for ClpVault liquidity providers"]},{"name":"tokenVaultA","isMut":true,"isSigner":false},{"name":"tokenVaultB","isMut":true,"isSigner":false},{"name":"positionBundleTokenAccount","isMut":false,"isSigner":false},{"name":"clpProgram","isMut":false,"isSigner":false},{"name":"clp","isMut":true,"isSigner":false,"docs":["the CLP program."]},{"name":"clpTokenVaultA","isMut":true,"isSigner":false},{"name":"clpTokenVaultB","isMut":true,"isSigner":false},{"name":"tokenAFeeAccount","isMut":true,"isSigner":false},{"name":"tokenBFeeAccount","isMut":true,"isSigner":false},{"name":"tokenProgram","isMut":false,"isSigner":false}],"args":[{"name":"lpAmount","type":"u64"},{"name":"tokenMinA","type":"u64"},{"name":"tokenMinB","type":"u64"}]},{"name":"openPosition","accounts":[{"name":"payer","isMut":true,"isSigner":true,"docs":["The address that is funding opening the Position"]},{"name":"marketMakingKey","isMut":false,"isSigner":true,"docs":["The CLP Vault's market maker. The key must sign the transaction."]},{"name":"clpVault","isMut":true,"isSigner":false},{"name":"clp","isMut":false,"isSigner":false},{"name":"clpProgram","isMut":false,"isSigner":false},{"name":"bundledPosition","isMut":true,"isSigner":false},{"name":"positionBundle","isMut":true,"isSigner":false},{"name":"positionBundleTokenAccount","isMut":false,"isSigner":false},{"name":"rent","isMut":false,"isSigner":false},{"name":"systemProgram","isMut":false,"isSigner":false}],"args":[{"name":"positionIndex","type":"u8"},{"name":"tickLowerIndex","type":"i32"},{"name":"tickUpperIndex","type":"i32"}]},{"name":"closePosition","accounts":[{"name":"receiver","isMut":true,"isSigner":false,"docs":["The address that is receiving rent from closing the position"]},{"name":"marketMakingKey","isMut":false,"isSigner":true,"docs":["The CLP Vault's market maker. The key must sign the transaction."]},{"name":"clpVault","isMut":true,"isSigner":false},{"name":"clp","isMut":false,"isSigner":false},{"name":"clpProgram","isMut":false,"isSigner":false},{"name":"bundledPosition","isMut":true,"isSigner":false},{"name":"positionBundle","isMut":true,"isSigner":false},{"name":"positionBundleTokenAccount","isMut":false,"isSigner":false}],"args":[{"name":"positionIndex","type":"u8"}]},{"name":"increaseLiquidity","accounts":[{"name":"marketMakingKey","isMut":false,"isSigner":true,"docs":["The CLP Vault's market maker. The key must sign the transaction."]},{"name":"clpVault","isMut":false,"isSigner":false},{"name":"tokenVaultA","isMut":true,"isSigner":false},{"name":"tokenVaultB","isMut":true,"isSigner":false},{"name":"positionBundleTokenAccount","isMut":false,"isSigner":false},{"name":"position","isMut":true,"isSigner":false},{"name":"tickArrayLower","isMut":true,"isSigner":false},{"name":"tickArrayUpper","isMut":true,"isSigner":false},{"name":"clpProgram","isMut":false,"isSigner":false},{"name":"clp","isMut":true,"isSigner":false,"docs":["the CLP program."]},{"name":"clpTokenVaultA","isMut":true,"isSigner":false},{"name":"clpTokenVaultB","isMut":true,"isSigner":false},{"name":"tokenProgram","isMut":false,"isSigner":false}],"args":[{"name":"liquidityAmount","type":"u128"},{"name":"tokenMaxA","type":"u64"},{"name":"tokenMaxB","type":"u64"},{"name":"positionIndex","type":"u8"}]},{"name":"decreaseLiquidity","accounts":[{"name":"marketMakingKey","isMut":false,"isSigner":true,"docs":["The CLP Vault's market maker. The key must sign the transaction."]},{"name":"clpVault","isMut":false,"isSigner":false},{"name":"tokenVaultA","isMut":true,"isSigner":false},{"name":"tokenVaultB","isMut":true,"isSigner":false},{"name":"positionBundleTokenAccount","isMut":false,"isSigner":false},{"name":"position","isMut":true,"isSigner":false},{"name":"tickArrayLower","isMut":true,"isSigner":false},{"name":"tickArrayUpper","isMut":true,"isSigner":false},{"name":"clpProgram","isMut":false,"isSigner":false},{"name":"clp","isMut":true,"isSigner":false,"docs":["the CLP program."]},{"name":"clpTokenVaultA","isMut":true,"isSigner":false},{"name":"clpTokenVaultB","isMut":true,"isSigner":false},{"name":"tokenProgram","isMut":false,"isSigner":false}],"args":[{"name":"liquidityAmount","type":"u128"},{"name":"tokenMinA","type":"u64"},{"name":"tokenMinB","type":"u64"},{"name":"positionIndex","type":"u8"}]},{"name":"collectRewards","accounts":[{"name":"payer","isMut":false,"isSigner":true},{"name":"clp","isMut":true,"isSigner":false},{"name":"clpProgram","isMut":false,"isSigner":false},{"name":"clpVault","isMut":false,"isSigner":false},{"name":"positionBundleTokenAccount","isMut":false,"isSigner":false},{"name":"tokenVaultA","isMut":true,"isSigner":false},{"name":"tokenVaultB","isMut":true,"isSigner":false},{"name":"tokenARewardVault","isMut":true,"isSigner":false},{"name":"tokenBRewardVault","isMut":true,"isSigner":false},{"name":"tokenAFeeAccount","isMut":true,"isSigner":false},{"name":"tokenBFeeAccount","isMut":true,"isSigner":false},{"name":"tokenProgram","isMut":false,"isSigner":false}],"args":[]},{"name":"collectFees","accounts":[{"name":"payer","isMut":false,"isSigner":true},{"name":"clpVault","isMut":false,"isSigner":false},{"name":"clp","isMut":true,"isSigner":false},{"name":"clpProgram","isMut":false,"isSigner":false},{"name":"positionBundleTokenAccount","isMut":false,"isSigner":false},{"name":"tokenVaultA","isMut":true,"isSigner":false},{"name":"clpTokenVaultA","isMut":true,"isSigner":false},{"name":"tokenVaultB","isMut":true,"isSigner":false},{"name":"clpTokenVaultB","isMut":true,"isSigner":false},{"name":"feeAccountTokenA","isMut":true,"isSigner":false},{"name":"feeAccountTokenB","isMut":true,"isSigner":false},{"name":"mmFeeAccountTokenA","isMut":true,"isSigner":false},{"name":"mmFeeAccountTokenB","isMut":true,"isSigner":false},{"name":"tokenProgram","isMut":false,"isSigner":false}],"args":[]},{"name":"updateTokenMeta","accounts":[{"name":"payer","isMut":false,"isSigner":true},{"name":"metadataAccount","isMut":true,"isSigner":false},{"name":"tokenAMetadataAccount","isMut":false,"isSigner":false},{"name":"tokenBMetadataAccount","isMut":false,"isSigner":false},{"name":"clpVault","isMut":false,"isSigner":false},{"name":"lpMint","isMut":false,"isSigner":false},{"name":"clp","isMut":false,"isSigner":false},{"name":"metadataProgram","isMut":false,"isSigner":false},{"name":"rent","isMut":false,"isSigner":false},{"name":"systemProgram","isMut":false,"isSigner":false}],"args":[{"name":"uri","type":"string"}]},{"name":"setVaultRatioCache","accounts":[{"name":"clpVault","isMut":true,"isSigner":false,"docs":["The CLMM Vault for which the cache is being created"]},{"name":"tokenVaultA","isMut":false,"isSigner":false},{"name":"tokenVaultB","isMut":false,"isSigner":false},{"name":"clpProgram","isMut":false,"isSigner":false},{"name":"clp","isMut":true,"isSigner":false,"docs":["the CLP program."]},{"name":"lpMint","isMut":true,"isSigner":false}],"args":[]},{"name":"externalSwapSetup","docs":["The market maker calls this ix first (other than compute program ixes) in a tx to swap one","asset for another. The cleanup ix must be last in the same tx, and the swap must use","Jupiter."],"accounts":[{"name":"marketMakingKey","isMut":false,"isSigner":true,"docs":["Gains authority to transfer funds from the pool until the end of the ix."]},{"name":"clpVault","isMut":true,"isSigner":false},{"name":"source","isMut":true,"isSigner":false},{"name":"dest","isMut":false,"isSigner":false},{"name":"tokenProgram","isMut":false,"isSigner":false},{"name":"instructionSysvar","isMut":false,"isSigner":false}],"args":[{"name":"amount","type":"u64"}]},{"name":"externalSwapCleanup","docs":["The market maker calls this ix last in a tx to swap one asset for another."],"accounts":[{"name":"marketMakingKey","isMut":false,"isSigner":true,"docs":["Gained authority to transfer funds from the pool until the end of the ix."]},{"name":"clpVault","isMut":true,"isSigner":false},{"name":"source","isMut":false,"isSigner":false},{"name":"dest","isMut":false,"isSigner":false},{"name":"tokenProgram","isMut":false,"isSigner":false}],"args":[]}],"accounts":[{"name":"ClpVault","type":{"kind":"struct","fields":[{"name":"bumpSeed","type":"u8"},{"name":"featuresEnabled","type":"u8"},{"name":"swapCache","type":{"defined":"SwapCache"}},{"name":"padding0","type":{"array":["u8",6]}},{"name":"nonce","docs":["A nonce to allow more than one CLP Vault with the same trading pair for the same admin"],"type":"u16"},{"name":"padding1","type":{"array":["u8",14]}},{"name":"clp","docs":["The address of the concentrated liquidity pool. E.g. Orca Whirlpool address"],"type":"publicKey"},{"name":"lpMint","docs":["The SPL token Mint address for the LP tokens"],"type":"publicKey"},{"name":"lpMintBump","type":"u8"},{"name":"padding2","type":{"array":["u8",15]}},{"name":"tokenMintA","docs":["SPL token Mint A of the trading pair"],"type":"publicKey"},{"name":"tokenVaultA","docs":["An SPL token Account for staging A tokens"],"type":"publicKey"},{"name":"tokenMintB","docs":["SPL Token mint B of the trading pair"],"type":"publicKey"},{"name":"tokenVaultB","docs":["An SPL token Account for staging B tokens"],"type":"publicKey"},{"name":"performanceFee","docs":["A percentage of the trading fees and rewards taken by the CLP Vault"],"type":"u32"},{"name":"padding3","type":{"array":["u8",12]}},{"name":"withdrawalFee","docs":["A fee percentage taken upon withdrawing"],"type":"u32"},{"name":"padding4","type":{"array":["u8",12]}},{"name":"marketMakingFee","docs":["A percentage of the performance_fee that gets paid to the market_maker."],"type":"u32"},{"name":"padding5","type":{"array":["u8",12]}},{"name":"strategy","docs":["The strategy that is enlisted by the vault"],"type":{"defined":"StrategyType"}},{"name":"padding6","type":{"array":["u8",15]}},{"name":"marketMakingKey","docs":["The key that has the ability to adjust positions and rebalance"],"type":"publicKey"},{"name":"adminKey","docs":["The key that has the ability to change the market_making_key and strategy."],"type":"publicKey"},{"name":"feeOwner","docs":["The key that must be the owner of SPL Token Accounts that receive fees"],"type":"publicKey"},{"name":"numActivePositions","docs":["The number of active Positions the vault has on the CLP"],"type":"u8"},{"name":"padding7","type":{"array":["u8",15]}},{"name":"positionBundleTokenAccount","docs":["The TokenAccount owned by the ClpVault that controls the PositionBundle"],"type":"publicKey"},{"name":"positionBundleMint","docs":["The mint address of the whirlpool PositionBundle"],"type":"publicKey"},{"name":"positionBundle","docs":["The Whirlpool PositionBundle account"],"type":"publicKey"},{"name":"positions","docs":["A slice of the active position information"],"type":{"array":[{"defined":"VaultPosition"},5]}},{"name":"initialTokenRatio","docs":["The initial amount of tokenA to tokenB required per LP token when there is 0 liquidity on","positions or in the reserve. This is only used for the inital deposit into the vault."],"type":{"defined":"TokenRatio"}},{"name":"stakePool","docs":["A key indicating the primary StakePool for the vault. This is used as reference for UIs."],"type":"publicKey"},{"name":"ratioCache","type":{"defined":"VaultRatioCache"}},{"name":"reserved0","type":{"array":["u8",448]}},{"name":"reserved1","type":{"array":["u128",32]}}]}}],"types":[{"name":"VaultRatioCache","type":{"kind":"struct","fields":[{"name":"totalTokenA","docs":["Total amount of tokenA managed by the vault"],"type":"u64"},{"name":"totalTokenB","docs":["Total amount of tokenB managed by the vault"],"type":"u64"},{"name":"lpSupply","docs":["The total supply of vault LP tokens"],"type":"u64"},{"name":"cachedAt","docs":["The Unix timestamp for when the cache was last updated"],"type":"i64"}]}},{"name":"TokenRatio","type":{"kind":"struct","fields":[{"name":"tokenA","docs":["The amount of token a required for the initial deposit"],"type":"u64"},{"name":"tokenB","docs":["The amount of token b required for the initial deposit"],"type":"u64"}]}},{"name":"VaultPosition","type":{"kind":"struct","fields":[{"name":"positionKey","docs":["The underlying CLP position."],"type":"publicKey"},{"name":"lowerTick","docs":["The address of the lower TickArray"],"type":"i32"},{"name":"padding0","type":{"array":["u8",12]}},{"name":"upperTick","docs":["The address of the upper TickArray"],"type":"i32"},{"name":"padding1","type":{"array":["u8",12]}},{"name":"reserve","type":{"array":["u128",16]}}]}},{"name":"SwapCache","docs":["Caches flags passed between the external setup and cleanup ixes."],"type":{"kind":"struct","fields":[{"name":"sourceStatus","type":{"defined":"SourceState"}},{"name":"cacheState","type":{"defined":"CacheState"}},{"name":"padding1","type":{"array":["u8",6]}}]}},{"name":"ClpProvider","type":{"kind":"enum","variants":[{"name":"ORCA"}]}},{"name":"StrategyType","type":{"kind":"enum","variants":[{"name":"PriceDiscovery"},{"name":"VolatilePair"},{"name":"StablePair"},{"name":"StableSlowlyDiverging"}]}},{"name":"CacheState","type":{"kind":"enum","variants":[{"name":"Default"},{"name":"Ready"},{"name":"Consumed"}]}},{"name":"SourceState","type":{"kind":"enum","variants":[{"name":"Default"},{"name":"SourceIsA"},{"name":"SourceIsB"}]}}],"events":[{"name":"CollectedFeesEvent","fields":[{"name":"a","type":"u64","index":false},{"name":"b","type":"u64","index":false},{"name":"vault","type":"publicKey","index":false}]},{"name":"CollectedRewardsEvent","fields":[{"name":"a","type":"u64","index":false},{"name":"b","type":"u64","index":false},{"name":"vault","type":"publicKey","index":false}]},{"name":"DepositEvent","fields":[{"name":"vault","type":"publicKey","index":false},{"name":"user","type":"publicKey","index":false},{"name":"a","type":"u64","index":false},{"name":"b","type":"u64","index":false},{"name":"lp","type":"u64","index":false},{"name":"prevLpSupply","type":"u64","index":false},{"name":"uncollectedFeesRewardsA","type":"u64","index":false},{"name":"uncollectedFeesRewardsB","type":"u64","index":false}]},{"name":"WithdrawEvent","fields":[{"name":"vault","type":"publicKey","index":false},{"name":"user","type":"publicKey","index":false},{"name":"a","type":"u64","index":false},{"name":"b","type":"u64","index":false},{"name":"lp","type":"u64","index":false},{"name":"wFeeA","type":"u64","index":false},{"name":"wFeeB","type":"u64","index":false},{"name":"prevLpSupply","type":"u64","index":false},{"name":"uncollectedFeesRewardsA","type":"u64","index":false},{"name":"uncollectedFeesRewardsB","type":"u64","index":false}]}],"errors":[{"code":6000,"name":"UnknownClp","msg":"CLP is unknown"},{"code":6001,"name":"MintAClpMismatch","msg":"TokenAMint does not match underlying CLP"},{"code":6002,"name":"MintBClpMismatch","msg":"TokenBMint does not match underlying CLP"},{"code":6003,"name":"PositionBundleAlreadyCreated","msg":"PositionBundle was already created"},{"code":6004,"name":"MaxPositionsExceeded","msg":"Max positions exceeded"},{"code":6005,"name":"PositionExistsAtIndex","msg":"Position exists at index"},{"code":6006,"name":"MarketMakerMustSign","msg":"Market maker must sign for this instruction"},{"code":6007,"name":"ClpMismatch","msg":"CLP does not match the ClpVault state"},{"code":6008,"name":"MaxActivePositonsNotOne","msg":"Max active positions greater than 1"},{"code":6009,"name":"VaultPositionLiquidityIssue","msg":"VaultPosition liquidity should be 0 when supply is 0"},{"code":6010,"name":"MaxTokenAmountExceeded","msg":"Max token amount exceeded"},{"code":6011,"name":"PositionBundleTokenAccountMismatch","msg":"Position bundle token account does not match ClpVault"},{"code":6012,"name":"PositionAccountsDoNotMatch","msg":"Position accounts do not match vault position at correct index"},{"code":6013,"name":"TokenVaultAMismatch","msg":"Token Vault A does not match ClpVault"},{"code":6014,"name":"TokenVaultBMismatch","msg":"Token Vault B does not match ClpVault"},{"code":6015,"name":"LpMintMismatch","msg":"LP mint does not match ClpVault"},{"code":6016,"name":"RemainingAccountsMissingVaultPositions","msg":"Remaining accounts is missing the VaultPositions"},{"code":6017,"name":"MinimumTokensNotReturned","msg":"Expected minimum tokens not returned"},{"code":6018,"name":"InccorectAdminKey","msg":"Incorrect admin key"},{"code":6019,"name":"IncorrectFeeOwner","msg":"Fee account is not owned by fee_owner"},{"code":6020,"name":"UnknownPosition","msg":"Failed to deserialize position at that key"},{"code":6021,"name":"IncorrectMMFeeOwner","msg":"MM fee account is not owned by market_making_key"},{"code":6022,"name":"MetadataDeserializationFailed","msg":"Metadata deserialization failed"},{"code":6023,"name":"AccountMustBeOwnedByClpProgram","msg":"Clp program does not own clp"},{"code":6024,"name":"IncorrectAuthority","msg":"Incorrect Authority"},{"code":6025,"name":"SetupNotFirst","msg":"Setup must be the first IX in the TX."},{"code":6026,"name":"CleanupIxNotFound","msg":"Cleanup ix must be the last IX in the TX."},{"code":6027,"name":"IxForbidden","msg":"IX in the TX not allowed: Compute, Jupiter, Psy CLP, Psy Token Exchange."},{"code":6028,"name":"InvalidSwapVault","msg":"Invalid source or destination: not the Clp's a or b vault."},{"code":6029,"name":"CacheStateSanityCheck","msg":"Failed cache state sanity check."},{"code":6030,"name":"SwapFeatureDisabled","msg":"The swap feature is currently disabled."}]}