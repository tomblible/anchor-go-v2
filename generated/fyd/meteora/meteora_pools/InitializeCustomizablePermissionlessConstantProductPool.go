// Code generated by https://github.com/gagliardetto/anchor-go. DO NOT EDIT.

package meteora_pools

import (
	"bytes"
	"fmt"

	binary "github.com/gagliardetto/binary"
	solanago "github.com/gagliardetto/solana-go"
	programparser "github.com/yydsqu/solana-sdk/program_parser"
)

// Builds a "initialize_customizable_permissionless_constant_product_pool" instruction.

// Initialize permissionless pool with customizable params
type InitializeCustomizablePermissionlessConstantProductPool struct {
	// Params:
	TokenAAmount uint64
	TokenBAmount uint64
	Params       CustomizableParams
	// Accounts:
	// [0] = [writable] pool
	Pool solanago.PublicKey `bin:"-"`
	// [1] = [writable] lp_mint
	LpMint solanago.PublicKey `bin:"-"`
	// [2] = [] token_a_mint
	TokenAMint solanago.PublicKey `bin:"-"`
	// [3] = [] token_b_mint
	TokenBMint solanago.PublicKey `bin:"-"`
	// [4] = [writable] a_vault
	AVault solanago.PublicKey `bin:"-"`
	// [5] = [writable] b_vault
	BVault solanago.PublicKey `bin:"-"`
	// [6] = [writable] a_token_vault
	ATokenVault solanago.PublicKey `bin:"-"`
	// [7] = [writable] b_token_vault
	BTokenVault solanago.PublicKey `bin:"-"`
	// [8] = [writable] a_vault_lp_mint
	AVaultLpMint solanago.PublicKey `bin:"-"`
	// [9] = [writable] b_vault_lp_mint
	BVaultLpMint solanago.PublicKey `bin:"-"`
	// [10] = [writable] a_vault_lp
	AVaultLp solanago.PublicKey `bin:"-"`
	// [11] = [writable] b_vault_lp
	BVaultLp solanago.PublicKey `bin:"-"`
	// [12] = [writable] payer_token_a
	PayerTokenA solanago.PublicKey `bin:"-"`
	// [13] = [writable] payer_token_b
	PayerTokenB solanago.PublicKey `bin:"-"`
	// [14] = [writable] payer_pool_lp
	PayerPoolLp solanago.PublicKey `bin:"-"`
	// [15] = [writable] protocol_token_a_fee
	ProtocolTokenAFee solanago.PublicKey `bin:"-"`
	// [16] = [writable] protocol_token_b_fee
	ProtocolTokenBFee solanago.PublicKey `bin:"-"`
	// [17] = [writable,signer] payer
	Payer solanago.PublicKey `bin:"-"`
	// [18] = [] rent
	Rent solanago.PublicKey `bin:"-"`
	// [19] = [writable] mint_metadata
	MintMetadata solanago.PublicKey `bin:"-"`
	// [20] = [] metadata_program
	MetadataProgram solanago.PublicKey `bin:"-"`
	// [21] = [] vault_program
	VaultProgram solanago.PublicKey `bin:"-"`
	// [22] = [] token_program
	TokenProgram solanago.PublicKey `bin:"-"`
	// [23] = [] associated_token_program
	AssociatedTokenProgram solanago.PublicKey `bin:"-"`
	// [24] = [] system_program
	SystemProgram solanago.PublicKey `bin:"-"`
	// PublicKeySlice
	solanago.PublicKeySlice `bin:"-"`
}

func (obj InitializeCustomizablePermissionlessConstantProductPool) MarshalWithEncoder(encoder *binary.Encoder) (err error) {
	// Serialize `tokenAAmountParam`:
	if err = encoder.Encode(obj.TokenAAmount); err != nil {
		return fmt.Errorf("error while marshaling tokenAAmountParam:%w", err)
	}
	// Serialize `tokenBAmountParam`:
	if err = encoder.Encode(obj.TokenBAmount); err != nil {
		return fmt.Errorf("error while marshaling tokenBAmountParam:%w", err)
	}
	// Serialize `paramsParam`:
	if err = encoder.Encode(obj.Params); err != nil {
		return fmt.Errorf("error while marshaling paramsParam:%w", err)
	}
	return nil
}

func (obj *InitializeCustomizablePermissionlessConstantProductPool) UnmarshalWithDecoder(decoder *binary.Decoder) (err error) {
	// Deserialize `TokenAAmount`:
	if err = decoder.Decode(&obj.TokenAAmount); err != nil {
		return fmt.Errorf("error while unmarshaling TokenAAmount:%w", err)
	}
	// Deserialize `TokenBAmount`:
	if err = decoder.Decode(&obj.TokenBAmount); err != nil {
		return fmt.Errorf("error while unmarshaling TokenBAmount:%w", err)
	}
	// Deserialize `Params`:
	if err = decoder.Decode(&obj.Params); err != nil {
		return fmt.Errorf("error while unmarshaling Params:%w", err)
	}
	return nil
}

func (obj *InitializeCustomizablePermissionlessConstantProductPool) SetAccounts(accounts solanago.PublicKeySlice) (err error) {
	if len(accounts) < 25 {
		return fmt.Errorf("too few accounts, expect %d actual %d", 25, len(accounts))
	}
	obj.Pool = accounts[0]
	obj.LpMint = accounts[1]
	obj.TokenAMint = accounts[2]
	obj.TokenBMint = accounts[3]
	obj.AVault = accounts[4]
	obj.BVault = accounts[5]
	obj.ATokenVault = accounts[6]
	obj.BTokenVault = accounts[7]
	obj.AVaultLpMint = accounts[8]
	obj.BVaultLpMint = accounts[9]
	obj.AVaultLp = accounts[10]
	obj.BVaultLp = accounts[11]
	obj.PayerTokenA = accounts[12]
	obj.PayerTokenB = accounts[13]
	obj.PayerPoolLp = accounts[14]
	obj.ProtocolTokenAFee = accounts[15]
	obj.ProtocolTokenBFee = accounts[16]
	obj.Payer = accounts[17]
	obj.Rent = accounts[18]
	obj.MintMetadata = accounts[19]
	obj.MetadataProgram = accounts[20]
	obj.VaultProgram = accounts[21]
	obj.TokenProgram = accounts[22]
	obj.AssociatedTokenProgram = accounts[23]
	obj.SystemProgram = accounts[24]
	obj.PublicKeySlice = accounts
	return nil
}
func (obj *InitializeCustomizablePermissionlessConstantProductPool) PublicKeys() solanago.PublicKeySlice {
	return obj.PublicKeySlice
}

func (*InitializeCustomizablePermissionlessConstantProductPool) TypeID() binary.TypeID {
	return binary.TypeIDFromBytes(Instruction_InitializeCustomizablePermissionlessConstantProductPool)
}

func (*InitializeCustomizablePermissionlessConstantProductPool) NewInstance() programparser.Instruction {
	return new(InitializeCustomizablePermissionlessConstantProductPool)
}

func (obj *InitializeCustomizablePermissionlessConstantProductPool) GetRemainingAccounts() solanago.PublicKeySlice {
	if len(obj.PublicKeySlice) <= 25 {
		return nil
	}
	return obj.PublicKeySlice[25:]
}

// Builds a "initialize_customizable_permissionless_constant_product_pool" instruction.
// Initialize permissionless pool with customizable params
func NewInitializeCustomizablePermissionlessConstantProductPoolInstruction(
	// Params:
	tokenAAmountParam uint64,
	tokenBAmountParam uint64,
	paramsParam CustomizableParams,

	// Accounts:
	pool solanago.PublicKey,
	lpMint solanago.PublicKey,
	tokenAMint solanago.PublicKey,
	tokenBMint solanago.PublicKey,
	aVault solanago.PublicKey,
	bVault solanago.PublicKey,
	aTokenVault solanago.PublicKey,
	bTokenVault solanago.PublicKey,
	aVaultLpMint solanago.PublicKey,
	bVaultLpMint solanago.PublicKey,
	aVaultLp solanago.PublicKey,
	bVaultLp solanago.PublicKey,
	payerTokenA solanago.PublicKey,
	payerTokenB solanago.PublicKey,
	payerPoolLp solanago.PublicKey,
	protocolTokenAFee solanago.PublicKey,
	protocolTokenBFee solanago.PublicKey,
	payer solanago.PublicKey,
	rent solanago.PublicKey,
	mintMetadata solanago.PublicKey,
	metadataProgram solanago.PublicKey,
	vaultProgram solanago.PublicKey,
	tokenProgram solanago.PublicKey,
	associatedTokenProgram solanago.PublicKey,
	systemProgram solanago.PublicKey,
	remaining__ ...*solanago.AccountMeta,
) (*solanago.GenericInstruction, error) {
	var (
		err    error
		buf__  = new(bytes.Buffer)
		enc__  = binary.NewBorshEncoder(buf__)
		metas_ = make(solanago.AccountMetaSlice, 25, 25+len(remaining__))
	)

	// Encode the instruction discriminator.
	if err = enc__.WriteBytes(Instruction_InitializeCustomizablePermissionlessConstantProductPool[:], false); err != nil {
		return nil, fmt.Errorf("failed to write instruction discriminator: %w", err)
	}

	{
		// Serialize `tokenAAmountParam`:
		if err = enc__.Encode(tokenAAmountParam); err != nil {
			return nil, fmt.Errorf("error while marshaling tokenAAmountParam:%w", err)
		}
		// Serialize `tokenBAmountParam`:
		if err = enc__.Encode(tokenBAmountParam); err != nil {
			return nil, fmt.Errorf("error while marshaling tokenBAmountParam:%w", err)
		}
		// Serialize `paramsParam`:
		if err = enc__.Encode(paramsParam); err != nil {
			return nil, fmt.Errorf("error while marshaling paramsParam:%w", err)
		}
	}

	// Add the accounts to the instruction.
	{
		// [0] = [writable] pool
		// Pool account (PDA address)
		metas_[0] = solanago.NewAccountMeta(pool, true, false)
		// [1] = [writable] lp_mint
		// LP token mint of the pool
		metas_[1] = solanago.NewAccountMeta(lpMint, true, false)
		// [2] = [] token_a_mint
		// Token A mint of the pool. Eg: USDT
		metas_[2] = solanago.NewAccountMeta(tokenAMint, false, false)
		// [3] = [] token_b_mint
		// Token B mint of the pool. Eg: USDC
		metas_[3] = solanago.NewAccountMeta(tokenBMint, false, false)
		// [4] = [writable] a_vault
		// Vault account for token A. Token A of the pool will be deposit / withdraw from this vault account.
		metas_[4] = solanago.NewAccountMeta(aVault, true, false)
		// [5] = [writable] b_vault
		// Vault account for token B. Token B of the pool will be deposit / withdraw from this vault account.
		metas_[5] = solanago.NewAccountMeta(bVault, true, false)
		// [6] = [writable] a_token_vault
		// Token vault account of vault A
		metas_[6] = solanago.NewAccountMeta(aTokenVault, true, false)
		// [7] = [writable] b_token_vault
		// Token vault account of vault B
		metas_[7] = solanago.NewAccountMeta(bTokenVault, true, false)
		// [8] = [writable] a_vault_lp_mint
		// LP token mint of vault A
		metas_[8] = solanago.NewAccountMeta(aVaultLpMint, true, false)
		// [9] = [writable] b_vault_lp_mint
		// LP token mint of vault B
		metas_[9] = solanago.NewAccountMeta(bVaultLpMint, true, false)
		// [10] = [writable] a_vault_lp
		// LP token account of vault A. Used to receive/burn the vault LP upon deposit/withdraw from the vault.
		metas_[10] = solanago.NewAccountMeta(aVaultLp, true, false)
		// [11] = [writable] b_vault_lp
		// LP token account of vault B. Used to receive/burn vault LP upon deposit/withdraw from the vault.
		metas_[11] = solanago.NewAccountMeta(bVaultLp, true, false)
		// [12] = [writable] payer_token_a
		// Payer token account for pool token A mint. Used to bootstrap the pool with initial liquidity.
		metas_[12] = solanago.NewAccountMeta(payerTokenA, true, false)
		// [13] = [writable] payer_token_b
		// Admin token account for pool token B mint. Used to bootstrap the pool with initial liquidity.
		metas_[13] = solanago.NewAccountMeta(payerTokenB, true, false)
		// [14] = [writable] payer_pool_lp
		metas_[14] = solanago.NewAccountMeta(payerPoolLp, true, false)
		// [15] = [writable] protocol_token_a_fee
		// Protocol fee token account for token A. Used to receive trading fee.
		metas_[15] = solanago.NewAccountMeta(protocolTokenAFee, true, false)
		// [16] = [writable] protocol_token_b_fee
		// Protocol fee token account for token B. Used to receive trading fee.
		metas_[16] = solanago.NewAccountMeta(protocolTokenBFee, true, false)
		// [17] = [writable,signer] payer
		// Admin account. This account will be the admin of the pool, and the payer for PDA during initialize pool.
		metas_[17] = solanago.NewAccountMeta(payer, true, true)
		// [18] = [] rent
		// Rent account.
		metas_[18] = solanago.NewAccountMeta(rent, false, false)
		// [19] = [writable] mint_metadata
		metas_[19] = solanago.NewAccountMeta(mintMetadata, true, false)
		// [20] = [] metadata_program
		metas_[20] = solanago.NewAccountMeta(metadataProgram, false, false)
		// [21] = [] vault_program
		// Vault program. The pool will deposit/withdraw liquidity from the vault.
		metas_[21] = solanago.NewAccountMeta(vaultProgram, false, false)
		// [22] = [] token_program
		// Token program.
		metas_[22] = solanago.NewAccountMeta(tokenProgram, false, false)
		// [23] = [] associated_token_program
		// Associated token program.
		metas_[23] = solanago.NewAccountMeta(associatedTokenProgram, false, false)
		// [24] = [] system_program
		// System program.
		metas_[24] = solanago.NewAccountMeta(systemProgram, false, false)
		// append remaining metas
		metas_ = append(metas_, remaining__...)
	}

	// Create the instruction.
	return solanago.NewInstruction(
		ProgramID,
		metas_,
		buf__.Bytes(),
	), nil
}

// Builds a "BuildInitializeCustomizablePermissionlessConstantProductPool" instruction.
// Initialize permissionless pool with customizable params
func BuildInitializeCustomizablePermissionlessConstantProductPool(
	// Params:
	tokenAAmountParam uint64,
	tokenBAmountParam uint64,
	paramsParam CustomizableParams,

	// Accounts:
	pool solanago.PublicKey,
	lpMint solanago.PublicKey,
	tokenAMint solanago.PublicKey,
	tokenBMint solanago.PublicKey,
	aVault solanago.PublicKey,
	bVault solanago.PublicKey,
	aTokenVault solanago.PublicKey,
	bTokenVault solanago.PublicKey,
	aVaultLpMint solanago.PublicKey,
	bVaultLpMint solanago.PublicKey,
	aVaultLp solanago.PublicKey,
	bVaultLp solanago.PublicKey,
	payerTokenA solanago.PublicKey,
	payerTokenB solanago.PublicKey,
	payerPoolLp solanago.PublicKey,
	protocolTokenAFee solanago.PublicKey,
	protocolTokenBFee solanago.PublicKey,
	payer solanago.PublicKey,
	rent solanago.PublicKey,
	mintMetadata solanago.PublicKey,
	metadataProgram solanago.PublicKey,
	vaultProgram solanago.PublicKey,
	tokenProgram solanago.PublicKey,
	associatedTokenProgram solanago.PublicKey,
	systemProgram solanago.PublicKey,
	remaining__ ...*solanago.AccountMeta,
) *solanago.GenericInstruction {
	instruction_, _ := NewInitializeCustomizablePermissionlessConstantProductPoolInstruction(
		tokenAAmountParam,
		tokenBAmountParam,
		paramsParam,
		pool,
		lpMint,
		tokenAMint,
		tokenBMint,
		aVault,
		bVault,
		aTokenVault,
		bTokenVault,
		aVaultLpMint,
		bVaultLpMint,
		aVaultLp,
		bVaultLp,
		payerTokenA,
		payerTokenB,
		payerPoolLp,
		protocolTokenAFee,
		protocolTokenBFee,
		payer,
		rent,
		mintMetadata,
		metadataProgram,
		vaultProgram,
		tokenProgram,
		associatedTokenProgram,
		systemProgram,
		remaining__...,
	)
	return instruction_
}
